<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç”µç¼†è£…ç›˜é•¿åº¦è®¡ç®—å™¨</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 25px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            font-size: 20px;
            margin-bottom: 20px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            color: #555;
            font-size: 14px;
            margin-bottom: 5px;
        }

        input[type="number"] {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
            -webkit-appearance: none;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn-calculate {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
            margin-bottom: 20px;
            transition: transform 0.2s;
        }

        .btn-calculate:active {
            transform: scale(0.98);
        }

        .results {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-label {
            color: #666;
            font-size: 14px;
        }

        .result-value {
            color: #667eea;
            font-size: 18px;
            font-weight: bold;
        }

        .error {
            background: #ffebee;
            color: #c62828;
            padding: 12px;
            border-radius: 10px;
            margin-top: 10px;
            font-size: 14px;
            display: none;
        }

        .error.show {
            display: block;
        }

        /* é€‚é…æ¡Œé¢ */
        @media (min-width: 768px) {
            .container {
                padding: 35px;
            }

            h1 {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“ ç”µç¼†è£…ç›˜é•¿åº¦è®¡ç®—å™¨</h1>

        <div class="input-group">
            <label for="d1">ä¾§æ¿ç›´å¾„ (dâ‚)</label>
            <input type="number" id="d1" value="2000" step="0.1" placeholder="è¯·è¾“å…¥">
        </div>

        <div class="input-group">
            <label for="d2">ç­’ä½“ç›´å¾„ (dâ‚‚)</label>
            <input type="number" id="d2" value="1000" step="0.1" placeholder="è¯·è¾“å…¥">
        </div>

        <div class="input-group">
            <label for="l2">å†…å®½ (lâ‚‚)</label>
            <input type="number" id="l2" value="500" step="0.1" placeholder="è¯·è¾“å…¥">
        </div>

        <div class="input-group">
            <label for="D">çº¿ç¼†å¤–å¾„ (D)</label>
            <input type="number" id="D" value="50" step="0.1" placeholder="è¯·è¾“å…¥">
        </div>

        <div class="input-group">
            <label for="t">è£…ç›˜ä½™é‡ (t)</label>
            <input type="number" id="t" value="0" step="0.1" placeholder="å¯ä»¥ä¸º0">
        </div>

        <button class="btn-calculate" onclick="calculate()">ğŸ§® è®¡ç®—</button>

        <div class="error" id="error"></div>

        <div class="results" id="results" style="display: none;">
            <div class="result-item">
                <span class="result-label">å·ç¼†å±‚æ•° (P)</span>
                <span class="result-value" id="resultP">-</span>
            </div>
            <div class="result-item">
                <span class="result-label">æ¯å±‚åœˆæ•° (n)</span>
                <span class="result-value" id="resultN">-</span>
            </div>
            <div class="result-item">
                <span class="result-label">è£…ç›˜é•¿åº¦ (L)</span>
                <span class="result-value" id="resultL">-</span>
            </div>
        </div>
    </div>

    <script>
        function showError(message) {
            const errorEl = document.getElementById('error');
            errorEl.textContent = message;
            errorEl.classList.add('show');
            document.getElementById('results').style.display = 'none';
        }

        function hideError() {
            document.getElementById('error').classList.remove('show');
        }

        function calculate() {
            hideError();

            // è·å–è¾“å…¥å€¼
            const d1 = parseFloat(document.getElementById('d1').value);
            const d2 = parseFloat(document.getElementById('d2').value);
            const l2 = parseFloat(document.getElementById('l2').value);
            const D = parseFloat(document.getElementById('D').value);
            const t = parseFloat(document.getElementById('t').value);

            // éªŒè¯è¾“å…¥
            if (isNaN(d1) || isNaN(d2) || isNaN(l2) || isNaN(D) || isNaN(t)) {
                showError('è¯·å¡«å†™æ‰€æœ‰å‚æ•°');
                return;
            }

            if (d1 <= 0 || d2 <= 0 || l2 <= 0 || D <= 0) {
                showError('dâ‚ã€dâ‚‚ã€lâ‚‚ã€D å¿…é¡»ä¸ºæ­£æ•°');
                return;
            }

            if (t < 0) {
                showError('è£…ç›˜ä½™é‡ä¸èƒ½ä¸ºè´Ÿæ•°');
                return;
            }

            if (d1 <= d2) {
                showError('ä¾§æ¿ç›´å¾„(dâ‚)å¿…é¡»å¤§äºç­’ä½“ç›´å¾„(dâ‚‚)');
                return;
            }

            // è®¡ç®—å·ç¼†å±‚æ•° P
            const P_numerator = d1 - d2 - 2 * t - 0.2 * D;
            if (P_numerator < 0) {
                showError('æœ‰æ•ˆç©ºé—´ä¸è¶³ï¼Œæ— æ³•ç¼ ç»•ç”µç¼†');
                return;
            }
            const P = P_numerator / (1.8 * D);
            if (P <= 0) {
                showError('æ— æ³•ç¼ ç»•è‡³å°‘ä¸€å±‚ç”µç¼†');
                return;
            }

            // è®¡ç®—æ¯å±‚åœˆæ•° n
            const n = 0.95 * l2 / D;

            // è®¡ç®—æ€»é•¿åº¦ Lï¼ˆPå’Œnå‘ä¸‹å–æ•´ï¼‰
            const P_floor = Math.floor(P);
            const n_floor = Math.floor(n);
            const avg_diameter = d2 + 0.1 * D + 0.9 * D * P_floor;
            const L = (Math.PI * P_floor * n_floor * avg_diameter) / 1000;

            // æ˜¾ç¤ºç»“æœ
            document.getElementById('resultP').textContent = P.toFixed(1) + ' å±‚';
            document.getElementById('resultN').textContent = n.toFixed(1) + ' åœˆ';
            document.getElementById('resultL').textContent = L.toFixed(2) + ' ç±³';
            document.getElementById('results').style.display = 'block';
        }

        // æ”¯æŒå›è½¦é”®è®¡ç®—
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    calculate();
                }
            });
        });
    </script>
</body>
</html>
